<meta name='viewport' content='width=device-width, initial-scale=1'/><!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KCM - VISOR 3 SLOTS</title>
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { 
            --tg-bg: #1c2733; 
            --tg-panel: #17212b; --tg-blue: #2481cc; 
            --tg-green: #45ad5b; --tg-red: #d14e4e; --tg-text: #f5f5f5;
        }
        body { background: #070a0e; color: var(--tg-text); font-family: 'Open Sans', sans-serif; display: flex; justify-content: center; margin: 0; height: 80vh; overflow: hidden; }
        #app { width: 100%; max-width: 400px; height: 100vh; background: var(--tg-bg); display: flex; flex-direction: column; position: relative; }
        
        /* Cabe√ßalho */
        .tg-header { background: var(--tg-panel); padding: 12px; display: flex; align-items: center; border-bottom: 1px solid #000; z-index: 100; }
        .tg-avatar { width: 40px; height: 40px; background: linear-gradient(135deg, #50a2e3, #2481cc); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; margin-right: 12px; }
        .tg-info { flex-grow: 1; }
        .banca-header { text-align: right; }
        .banca-header b { font-size: 15px; color: #fff; display: block; }

        /* Chat */
        .visor-chat { flex-grow: 1; padding: 15px; overflow-y: auto; display: flex; flex-direction: column; background: url('https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png'); background-attachment: fixed; }
        
        .bubble { 
            max-width: 85%; padding: 12px; border-radius: 12px; margin-bottom: 12px; font-size: 13px; line-height: 1.5; color: white; align-self: flex-start; background: var(--tg-panel); border-bottom-left-radius: 2px; box-shadow: 0 2px 5px rgba(0,0,0,0.4); white-space: pre-wrap; word-wrap: break-word; border-left: 4px solid transparent;
        }
        .bubble-alert { border-left-color: #f0b90b; }
        .bubble-green { border-left-color: var(--tg-green); }
        .bubble-red { border-left-color: var(--tg-red); }
        .msg-time { display: block; text-align: right; font-size: 9px; opacity: 0.5; margin-top: 5px; }

        /* Footer e Config */
        .tg-footer { background: var(--tg-panel); padding: 12px; border-top: 1px solid #000; }
        #timer-box { font-weight: bold; color: var(--tg-blue); text-align: center; font-size: 11px; margin-bottom: 8px; }
        .btn-row { display: flex; justify-content: space-around; }
        .btn-nav { background: none; border: none; color: #8b949e; cursor: pointer; font-size: 10px; display: flex; flex-direction: column; align-items: center; }
        
        #config-tab { display: none; position: absolute; bottom: 80px; left: 10px; right: 10px; background: var(--tg-panel); padding: 15px; border-radius: 12px; border: 1px solid #444; z-index: 1000; box-shadow: 0 -5px 20px rgba(0,0,0,0.8); max-height: 80vh; overflow-y: auto; }
        .config-row { margin-bottom: 8px; }
        .config-row label { font-size: 9px; color: var(--tg-blue); font-weight: bold; display: block; margin-bottom: 2px; text-transform: uppercase; }
        select, input { width: 100%; background: #0e1621; border: 1px solid #333; color: white; padding: 5px; border-radius: 5px; font-size: 11px; }
    </style>
</head>
<body>

<div id="app">
    <div class="tg-header">
        <div class="tg-avatar">KC</div>
        <div class="tg-info">
            <b>KCM MASTER BOT</b>
            <div style="font-size: 10px; color: #8b949e;" id="placar-txt">‚úÖ 0 | ‚ùå 0</div>
        </div>
        <div class="banca-header">
            <small style="font-size: 8px; color: var(--tg-blue);">SALDO APP</small>
            <b id="banca-topo">R$ 5000.00</b>
        </div>
    </div>

    <div class="visor-chat" id="chat"></div>

    <div id="config-tab">
        <div class="config-row">
            <label>Estrat√©gia Operacional</label>
            <select id="selEstrategia">
                <option value="Fluxo Sniper">üéØ Fluxo Sniper</option>
                <option value="Regra 1">‚öñÔ∏è Regra 1</option>
                <option value="Zig Zag">üìâ Zig Zag</option>
                <option value="Sniper Retra√ß√£o">üèπ Sniper Retra√ß√£o</option>
            </select>
        </div>
        <hr style="border: 0; border-top: 1px solid #333; margin: 10px 0;">
        <div class="config-row"><label>Ativo Slot 1</label><select id="sel1"></select></div>
        <div class="config-row"><label>Ativo Slot 2</label><select id="sel2"></select></div>
        <div class="config-row"><label>Ativo Slot 3</label><select id="sel3"></select></div>
        
        <div style="display: flex; gap: 10px; margin-top: 10px;">
            <div class="config-row" style="flex:1"><label>Banca R$</label><input type="number" id="inpBanca" value="5000"></div>
            <div class="config-row" style="flex:1"><label>Payout %</label><input type="number" id="inpPay" value="95"></div>
        </div>
        <button onclick="salvarConfig()" style="width:100%; padding:10px; background:var(--tg-blue); color:white; border:none; border-radius:5px; font-weight:bold; cursor:pointer; margin-top: 10px;">SALVAR CONFIGURA√á√ïES</button>
    </div>

    <div class="tg-footer">
        <div id="timer-box">Aguardando sinais...</div>
        <div class="btn-row">
            <button class="btn-nav" onclick="toggleConfig()"><i class="fas fa-sliders-h" style="font-size:18px; margin-bottom:4px;"></i>AJUSTES</button>
            <button class="btn-nav" onclick="location.reload()"><i class="fas fa-sync" style="font-size:18px; margin-bottom:4px;"></i>RESET</button>
        </div>
    </div>
</div>

<script>
        // --- LISTA DE ATIVOS QUE VOC√ä ENVIOU ---
    const LISTA_ATIVOS = [
        { id: "NONE", nome: "‚ùå DESATIVAR SLOT" },
        { id: "1HZ10V", nome: "üìà Volatility 10 (1s)" },
        { id: "1HZ25V", nome: "üìà Volatility 25 (1s)" },
        { id: "1HZ50V", nome: "üìà Volatility 50 (1s)" },
        { id: "1HZ75V", nome: "üìà Volatility 75 (1s)" },
        { id: "1HZ100V", nome: "üìà Volatility 100 (1s)" },
        { id: "R_10", nome: "üìä Volatility 10" },
        { id: "R_25", nome: "üìä Volatility 25" },
        { id: "R_50", nome: "üìä Volatility 50" },
        { id: "R_75", nome: "üìä Volatility 75" },
        { id: "R_100", nome: "üìä Volatility 100" },
        { id: "JD10", nome: "üöÄ Jump 10" },
        { id: "JD25", nome: "üöÄ Jump 25" },
        { id: "JD50", nome: "üöÄ Jump 50" },
        { id: "JD75", nome: "üöÄ Jump 75" },
        { id: "JD100", nome: "üöÄ Jump 100" },
        { id: "BOOM300", nome: "üí• Boom 300" },
        { id: "BOOM500", nome: "üí• Boom 500" },
        { id: "BOOM1000", nome: "üí• Boom 1000" },
        { id: "CRASH300", nome: "üìâ Crash 300" },
        { id: "CRASH500", nome: "üìâ Crash 500" },
        { id: "CRASH1000", nome: "üìâ Crash 1000" },
        { id: "ST50", nome: "üé¢ Step Index" },
        { id: "frxEURUSD", nome: "üí± EUR/USD (Euro/D√≥lar)" },
        { id: "frxGBPUSD", nome: "üí± GBP/USD (Libra/D√≥lar)" },
        { id: "frxUSDJPY", nome: "üí± USD/JPY (D√≥lar/Iene)" },
        { id: "frxAUDUSD", nome: "üí± AUD/USD (D√≥lar Aus./D√≥lar)" },
        { id: "frxUSDCAD", nome: "üí± USD/CAD (D√≥lar/D√≥lar Can.)" },
        { id: "frxUSDCHF", nome: "üí± USD/CHF (D√≥lar/Franco Su√≠√ßo)" },
        { id: "frxEURGBP", nome: "üí± EUR/GBP (Euro/Libra)" },
        { id: "frxEURJPY", nome: "üí± EUR/JPY (Euro/Iene)" },
        { id: "frxGBPJPY", nome: "üí± GBP/JPY (Libra/Iene)" },
        { id: "frxXAUUSD", nome: "ü™ô OURO (XAU/USD)" },
        { id: "frxXAGUSD", nome: "ü•à PRATA (XAG/USD)" },
        { id: "frxXPDUSD", nome: "üß™ PAL√ÅDIO (XPD/USD)" },
        { id: "frxXPTUSD", nome: "‚ö™ PLATINA (XPT/USD)" },
        { id: "cryBTCUSD", nome: "‚Çø BITCOIN (BTC/USD)" },
        { id: "cryETHUSD", nome: "‚ô¢ ETHEREUM (ETH/USD)" },
        { id: "cryLTCUSD", nome: "≈Å LITECOIN (LTC/USD)" },
        { id: "cryXRPUSD", nome: "‚úï RIPPLE (XRP/USD)" },
        { id: "cryBCHUSD", nome: "‚Çø BITCOIN CASH (BCH/USD)" },
        { id: "cryEOSUSD", nome: "üåê EOS (EOS/USD)" },
        { id: "cryETHUSD", nome: "‚ô¢ ETHEREUM (ETH/USD)" }
    ];

    const socket = io("https://app-fl26.onrender.com");
    let wins = 0, reds = 0, bancaAtual = 5000, valorEntrada = 10;

    socket.on('sinal_app', (dados) => {
        let classe = '';
        if(dados.tipo === 'ALERTA') classe = 'bubble-alert';
        if(dados.tipo === 'RESULTADO') {
            classe = dados.resultado === 'WIN' ? 'bubble-green' : 'bubble-red';
            let pay = parseFloat(document.getElementById('inpPay').value) / 100;
            if(dados.resultado === 'WIN') { wins++; bancaAtual += (valorEntrada * pay); }
            else { reds++; bancaAtual -= valorEntrada; }
            document.getElementById('placar-txt').innerText = `‚úÖ ${wins} | ‚ùå ${reds}`;
            document.getElementById('banca-topo').innerText = `R$ ${bancaAtual.toFixed(2)}`;
        }
        addMsg(dados.texto, classe);
    });

    function addMsg(txt, classe) {
        const chat = document.getElementById('chat');
        const div = document.createElement('div');
        div.className = `bubble ${classe}`;
        const h = new Date().toLocaleTimeString().slice(0,5);
        div.innerHTML = `${txt.replace(/\n/g, '<br>')}<span class="msg-time">${h}</span>`;
        chat.appendChild(div);
        chat.scrollTop = chat.scrollHeight;
    }

    function toggleConfig() {
        const tab = document.getElementById('config-tab');
        tab.style.display = tab.style.display === 'block' ? 'none' : 'block';
    }

    function salvarConfig() {
        bancaAtual = parseFloat(document.getElementById('inpBanca').value);
        document.getElementById('banca-topo').innerText = `R$ ${bancaAtual.toFixed(2)}`;
        toggleConfig();
        addMsg("‚öôÔ∏è Configura√ß√µes Salvas!\nEstrat√©gia e Slots atualizados.", "");
    }

    window.onload = () => {
        // Carregar a lista nos 3 slots
        [1,2,3].forEach(i => {
            const sel = document.getElementById('sel'+i);
            LISTA_ATIVOS.forEach(a => {
                let opt = document.createElement('option');
                opt.value = a.id; opt.innerText = a.nome; sel.appendChild(opt);
            });
        });
        addMsg("ü§ñ Sistema KCM Online!\nEscolha os ativos nos Ajustes.", "");
    }

    setInterval(() => {
        const s = new Date().getSeconds();
        document.getElementById('timer-box').innerText = "Analisando vela: " + (60 - s) + "s";
    }, 1000);
</script>
</body>
</html>
